---
import Layout from "../../layouts/Layout.astro";

import { getCollection } from "astro:content";
const blog = await getCollection("blog");

// Sort posts
blog.sort((a, b) => {
    return new Date(b.data.publishDate).getTime() - new Date(a.data.publishDate).getTime();
});

// Grouping by year
const postsByYear = blog.reduce((acc, post) => {
    const year = new Date(post.data.publishDate).getFullYear();
    if (!acc[year]){
        acc[year] = [];
    }
    acc[year].push(post);
    return acc;
}, {});
---

<Layout title="Viktor Fejes - Blog">
    <article class="w-full max-w-8xl px-8 mt-64">
        <div class="w-full mb-32">
            <div class="w-full mb-16">
                <h2 class="text-8xl">Article List</h2>
            </div>
            <div class="w-full flex justify-end">
                <div class="w-full lg:max-w-[66.66%]">
                    <p class="text-2xl leading-snug max-w-xl">A collection of various write-ups about my adventures with all sorts of techniques and technologies.</p>
                </div>
            </div>
        </div>
        <!-- Don't have enough articles for this to make sense yet... -->
        <!-- <div class="search">
            <div class="search-group">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="search-icon"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
                <input type="text" name="blog-search" id="search" placeholder="Searchâ€¦">
            </div>
        </div> -->
        <!-- <div class="search-results"></div> -->
        <div class="mb-8">
            {blog.map((post) => (
                <article class="w-full relative group">
                    <div class="absolute -left-4 -right-4 top-1 bottom-1 bg-neutral-200 z-0 scale-y-0 group-hover:scale-y-100 transition"></div>
                    <a href=`/blog/${post.slug}` class="group-hover:text-neutral-950 group-hover:border-t-neutral-200 w-full flex justify-between items-center py-6 z-10 relative border-t last:border-b border-neutral-700 text-2xl transition">
                        <h3>{post.data.title}</h3>
                        <time class="" datetime={post.data.publishDate.toISOString()}>{post.data.publishDate.toLocaleDateString("en-US", {
                            year: "numeric",
                            month: "short",
                            day: "2-digit",
                        })}</time>
                        <span class="block opacity-0 group-hover:opacity-100">Read article</span>
                    </a>
                </article>
            ))}
        </div>
    </article>
</Layout>